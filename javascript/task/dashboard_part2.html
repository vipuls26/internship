<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>test User Dashboard</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
  </head>

    <style>

      .container{
        overflow-x: auto;
      }

  </style>

  <body>
  <form id="frm1" class="container mt-5">
  <div class="row g-3 justify-content-center align-items-end">

    <!-- Name -->
    <div class="col-12 col-md-6 col-lg-3">
      <label for="name" class="form-label">Name</label>
      <input
        type="text"
        id="name"
        class="form-control"
        placeholder="First name"
        required
      />
    </div>

    <!-- Age -->
    <div class="col-12 col-md-6 col-lg-2">
      <label for="age" class="form-label">Age</label>
      <input
        type="number"
        name="age"
        id="age"
        class="form-control"
        placeholder="Age"
        required
      />
    </div>

    <!-- Email -->
    <div class="col-12 col-md-6 col-lg-3">
      <label for="email" class="form-label">Email</label>
      <input
        type="email"
        name="email"
        id="email"
        class="form-control"
        placeholder="Email"
        required
      />
    </div>

    <!-- Button -->
    <div class="col-12 col-md-6 col-lg-2 d-grid">
      <label class="form-label d-none d-lg-block"></label>
      <input
        type="submit"
        value="Add"
        id="newUser"
        class="btn btn-success"
      />
    </div>

  </div>
</form>


    <div class="container my-5">
      <span id="demo" class="text-danger">No user fetch</span>
      <div class="spinner-border" id="spinner" role="status">
        <span class="sr-only"></span>
      </div>
    </div>

    <div class="container my-5">
      <button id="refresh" class="btn btn-success col-12 col-md-6 w-md-25 col-lg-2">Refresh</button>
    </div>

    <div class="container my-5"></div>

    <script>
      // api fetch data
      async function Fetchdata() {
        const rawdata = await fetch(
          "https://jsonplaceholder.typicode.com/users",
        );
        const apidata = await rawdata.json();

        //user profile
        const localdata = [
          { id: 11, name: "vipul", Age: 25, email: "vipul@gmail.com" },
          { id: 12, name: "jhon", Age: 19, email: "jhon@gmail.com" },
          { id: 13, name: "doe", Age: 28, email: "doe@gmail.com" },
          { id: 14, name: "snow", Age: 13, email: "snow@gmail.com" },
        ];

        var newarray = localdata.concat(apidata);
        //  console.log(newarray);

        //add user

        const formdata = document.getElementById("frm1");

        formdata.addEventListener("submit", function (element) {
          element.preventDefault();

          const name = document.getElementById("name").value;
          const age = document.getElementById("age").value;
          const email = document.getElementById("email").value;

          const newUser = {
            id: 15,
            name: name,
            Age: age,
            email: email,
          };

          // console.log(newUser);

          newarray.push(newUser);
          userlist();

          console.log(userlist());
        });

        //display user list
        const list = document.getElementById("demo");

        function userlist() {
          let html = `
     
      <table class="table table-border-dark">
          <tr class="table table-dark">
            <th>ID</th>
            <th>Name</th>
            <th>Age</th>
            <th>Email</th>
          </tr>
      `;

          newarray.forEach((element) => {
            console.log(element.Age);

            const age = element.Age === undefined ? 20 : element.Age;

            html +=
              `
           <tr class="user" data-age="${element.Age}">
            <td>${element.id}</td>
            <td>${element.name}</td>
            <td id="user">` +
              age +
              `</td>
            <td>${element.email}</td>
              
          </tr>

          
        `;
          });

          html += "</table>";
          list.innerHTML = html;
        }

        userlist();
      }

      Fetchdata();

      // refresh api data

      document.getElementById("refresh").addEventListener("click", function () {
        location.reload();
        Fetchdata();
      });

      //spiner

      function handlespinner() {
        document.getElementById("demo").style.display = "block";
        document.getElementById("spinner").style.display = "none";
      }

      setTimeout(handlespinner, 500);
    </script>
  </body>
</html>
